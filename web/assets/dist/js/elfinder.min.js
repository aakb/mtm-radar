!function(e){var n=null,i={},t=function(e,i){o(e,i),window.setValue=n},o=function(n,i){var t=/([^#]+)(?:#([0-9]+)(?::(.+))?)?/.exec(i);if(null!==t){i=t[1],index=void 0===t[2]?-1:parseInt(t[2]),method=void 0===t[3]?null:t[3];var o=e('[data-elfinder-id="'+i+'"]').closest(".elfinder").find("input"),a=[];try{a=JSON.parse(e(o).val())}catch(e){}index>-1?a.splice(index,"replace"===method?1:0,n):a.push(n),e(o).val(JSON.stringify(a)),v()}},a=function(n){return e(n).closest(".elfinder").find("input").data("elfinder-id")},l=function(n){return e(n).closest(".image").index()},d=function(e){return i.urls[e]},s=function(e){e=!0===e;var i=a(this),o=d(i);if(null!==o){var i=a(this),s=l(this);s>=0&&(i+="#"+(s+(e?0:1)),e&&(i+=":replace")),o+=(o.indexOf("?")<0?"?":"&")+"id="+encodeURIComponent(i),n=window.setValue,window.setValue=t,window.open(o,"elfinderWindow","height=450, width=900")}},c=function(e){return void 0!==i.messages&&void 0!==i.messages[e]?i.messages[e]:e},r=function(){if(confirm(c("Confirm remove image"))){var n=e(this).closest(".image"),i=e(n).closest(".elfinder").find("input"),t=[];try{t=JSON.parse(e(i).val())}catch(e){}var o=e(n).index();t.splice(o,1),e(i).val(JSON.stringify(t)),v()}},u=function(){confirm(c("Confirm replace image"))&&s.call(this,!0)},f=function(){var n=l(this),i=e(this).closest(".elfinder").find("input"),t=[];try{t=JSON.parse(e(i).val())}catch(e){}if(n>0){var o=t[n-1];t[n-1]=t[n],t[n]=o,e(i).val(JSON.stringify(t)),v()}},p=function(){var n=l(this),i=e(this).closest(".elfinder").find("input"),t=[];try{t=JSON.parse(e(i).val())}catch(e){}if(n<t.length){var o=t[n+1];t[n+1]=t[n],t[n]=o,e(i).val(JSON.stringify(t)),v()}},v=function(){e(".elfinder").each(function(){var n=e(this).find(".elfinder-ui");0===n.length&&(n=e('<div class="elfinder-ui"></div>').appendTo(this)),e(n).empty();var i=[];try{i=JSON.parse(e(this).find("input").val())}catch(e){}e(i).each(function(t,o){var a=e("<div/>",{class:"image"}).appendTo(n);e("<img/>",{src:o,class:"img-responsive"}).appendTo(a);var l=e("<div/>",{class:"controls"}).appendTo(a);t>0&&e('<button type="button"></button>').appendTo(l).on("click",f).html(c("Move image left")),t<i.length-1&&e('<button type="button"></button>').appendTo(l).on("click",p).html(c("Move image right")),e('<button type="button"></button>').appendTo(l).on("click",r).html(c("Remove image")),e('<button type="button"></button>').appendTo(l).on("click",u).html(c("Replace image"))});var t=e("<div/>",{class:"add-image"}).appendTo(n);e('<button type="button" class="btn"></button>').appendTo(t).on("click",s).html(c("Add image"))})};void 0!==window.elfinderSettings&&(i=window.elfinderSettings,e(".field-collection [data-prototype]").on("easyadmin.collection.item-added easyadmin.collection.item-deleted",function(e){v()}),v())}(jQuery);